# Copyright 2021, Proofcraft Pty Ltd
#
# SPDX-License-Identifier: BSD-2-Clause

---

# Hardware and simulation platform definitions for seL4 builds.

modes: [32, 64]
architectures: [x86, arm, riscv]

# platform-key:
#     arch: one of architectures; required
#     modes: list of modes; non-empty; required
#     smp: list of modes; optional (null = empty)
#     aarch_hyp: list of modes; optional (null = empty)
#     platform: name; required
#     image_platform: name; optional
#     has_simulation: boolean; optional; (null = false); platform has a simulation
#     march: string; optional
#     req: list of string; optional; names of test boards in machine queue
#     no_hw_test: optional; (null = false); no hw test on this platform
#     no_hw_build: optional; (null = false); no hw build for this platform (implies no_hw_test)

platforms:

  RISCVVIRT64:
    arch: riscv
    modes: [64]
    platform: qemu-riscv-virt
    has_simulation: true
    march: rv64imac
    no_hw_test: true
    no_hw_build: true

  RISCVVIRT32:
    arch: riscv
    modes: [32]
    platform: qemu-riscv-virt
    has_simulation: true
    march: rv32imac
    no_hw_test: true
    no_hw_build: true

  HIFIVE:
    arch: riscv
    modes: [64]
    smp: [64]
    platform: hifive
    req: [hifive] # , hifive1]
    march: rv64imac

  ARMVIRT64:
    arch: arm
    modes: [64]
    platform: qemu-arm-virt
    has_simulation: true
    march: armv8a # Cortex-A53 is emulated by default
    no_hw_test: true
    no_hw_build: true

  ODROID_XU4:
    arch: arm
    modes: [32]
    aarch_hyp: [32]
    platform: exynos5422
    req: [odroidxu4_2]
    image_platform: exynos5
    march: armv7a

  TX1:
    arch: arm
    modes: [64]
    smp: [64]
    aarch_hyp: [64]
    platform: tx1
    req: [tx1a]
    march: armv8a

  PC99:
    arch: x86
    modes: [32, 64]
    smp: [32, 64]
    platform: x86_64
    req: [skylake, haswell3, haswell4, skylake2]
    has_simulation: true
    march: nehalem

# platforms where MCS is wholly unsupported
# (for platforms with partial support see sel4test-hw/build.py and comments below)
mcs_unsupported_platforms:
  # both fail SCHED0012 and debug assertions on boot:
  - IMX8MQ_EVK
  - MAAXBOARD
  # unsupported for specific configs: ODROID_X4, TX2
  # unsupported for multicore: SABRE, IMX8MM_EVK
  # see also https://github.com/seL4/ci-actions/blob/master/sel4test-hw/build.py
  # function "build_filter" for more MCS exclusions
